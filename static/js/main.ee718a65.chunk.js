(this["webpackJsonpweb-audio-api-v2-issue-7"]=this["webpackJsonpweb-audio-api-v2-issue-7"]||[]).push([[0],[,,function(e,t,a){e.exports={App:"app_App__3ALCk",Loading:"app_Loading__ylwSY"}},function(e,t,a){e.exports={svg:"analyser-chart_svg__2S828"}},,,,,,function(e,t,a){e.exports={Col:"col_Col__1zaJG"}},,function(e,t,a){e.exports={Row:"row_Row__2P6i2"}},function(e){e.exports=JSON.parse('{"a":"web-audio-api-v2-issue-7"}')},,function(e,t,a){e.exports=a(23)},,,,,,,,function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(6),l=a.n(c),u=a(4),s=a.n(u),o=a(7),i=a(1),m=a(8),f=a(3),p=function(e){var t=e.analyser,a=e.chartType,c=Object(n.useState)(),l=Object(i.a)(c,2),u=l[0],s=l[1],o=Object(n.useState)(""),m=Object(i.a)(o,2),p=m[0],d=m[1],E=r.a.useRef(),v=function e(){var n;if(t&&("waveform"===a?(n=new Float32Array(t.fftSize),t.getFloatTimeDomainData(n)):"fft"===a&&(n=new Float32Array(t.frequencyBinCount),t.getFloatFrequencyData(n)),n)){var r=n.reduce((function(e,t,a){return"".concat(e," M").concat(a,",0 L").concat(a,",").concat(t)}),"");d(r)}E.current=requestAnimationFrame(e)};return Object(n.useLayoutEffect)((function(){return E.current=requestAnimationFrame(v),function(){return cancelAnimationFrame(E.current)}}),[]),Object(n.useEffect)((function(){t&&("waveform"===a?s("0 -1 ".concat(t.fftSize," 2")):"fft"===a&&s("0 -120 ".concat(t.frequencyBinCount," 120")))}),[t,a]),r.a.createElement("svg",{preserveAspectRatio:"none",className:f.svg,viewBox:u},r.a.createElement("path",{stroke:"black",d:p}))},d=function(e){var t=e.playType,a=e.choices,n=e.setPlayType;return r.a.createElement("div",null,"audio output:",r.a.createElement("br",null),a.map((function(e){return r.a.createElement("button",{key:e,disabled:e===t,onClick:function(){return n(e)}},e)})))},E=a(9),v=function(e){var t=e.children;return r.a.createElement("div",{className:E.Col},t)},y=a(10),T=a.n(y),b=function(e){for(var t=e.numCycles,a=e.pulseWidth,n="",c=100*t,l=0;l<t;l++)for(var u=0;u<100;u++){var s=u/100<a?-1:1,o=100*l+u;n+="M".concat(o,",0 L").concat(o,",").concat(s)}return r.a.createElement("svg",{className:f.svg,preserveAspectRatio:"none",viewBox:"0 -1 ".concat(c," 2")},r.a.createElement("path",{stroke:"black",d:n}))},g=a(13),w=function(e){var t=e.presets,a=e.setter,n=Object(g.a)(e,["presets","setter"]);return r.a.createElement("div",null,n.name,":\xa0",r.a.createElement("small",null,n.value),r.a.createElement("br",null),r.a.createElement("input",Object.assign({},n,{type:"range",onChange:function(e){return a(parseFloat(e.target.value))}})),r.a.createElement("br",null),(t||[]).map((function(e){return r.a.createElement("button",{key:e,disabled:n.value===e,onClick:function(){return a(e)},style:{marginBottom:10}},e)})))},h=a(11),A=function(e){var t=e.children;return r.a.createElement("div",{className:h.Row},t)},O=a(2),j=a(12),k=Math.pow(2,12),N="stopped",S="worklet",V="custom",x="square",C=new AudioContext,_=new GainNode(C,{gain:0});_.connect(C.destination);var q=new OscillatorNode(C,{detune:0,frequency:440,type:"square"}),F=new AnalyserNode(C,{smoothingTimeConstant:0}),L=new GainNode(C,{gain:0});q.connect(L),L.connect(_),q.connect(F),q.start();var W,B,P,R=new OscillatorNode(C,{detune:0,frequency:440}),z=new AnalyserNode(C,{smoothingTimeConstant:0}),G=new GainNode(C,{gain:0});R.connect(G),G.connect(_),R.connect(z),R.start();var M=function(){var e=Object(n.useState)(440),t=Object(i.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(0),u=Object(i.a)(l,2),f=u[0],E=u[1],y=Object(n.useState)(.5),g=Object(i.a)(y,2),h=g[0],M=g[1],J=Object(n.useState)(0),D=Object(i.a)(J,2),I=D[0],Y=D[1],H=Object(n.useState)(N),K=Object(i.a)(H,2),Q=K[0],U=K[1],X=Object(n.useState)(!1),Z=Object(i.a)(X,2),$=Z[0],ee=Z[1],te=Object(n.useState)(),ae=Object(i.a)(te,2),ne=ae[0],re=ae[1],ce=function(){for(var e=k*h,t=[],a=0;a<k;a++)t[a]=a<e?-1:1;var n=new m.FFT(t.length);n.forward(t);var r=C.createPeriodicWave(new Float32Array(n.real),new Float32Array(n.imag),{disableNormalization:!1});R.setPeriodicWave(r)};return Object(n.useEffect)((function(){R.frequency.setValueAtTime(a,C.currentTime),q.frequency.setValueAtTime(a,C.currentTime),W&&W.parameters.get("frequency").setValueAtTime(a,C.currentTime)}),[a]),Object(n.useEffect)((function(){R.detune.setValueAtTime(f,C.currentTime),q.detune.setValueAtTime(f,C.currentTime),W&&W.parameters.get("detune").setValueAtTime(f,C.currentTime)}),[f]),Object(n.useEffect)((function(){ce(),W&&W.parameters.get("pulseWidth").setValueAtTime(h,C.currentTime)}),[h]),Object(n.useEffect)((function(){_.gain.value=I}),[I]),Object(n.useEffect)((function(){Q!==N&&"suspended"===C.state&&C.resume(),Q===N?C.suspend():Q===S?(G.gain.setValueAtTime(0,C.currentTime),L.gain.setValueAtTime(0,C.currentTime),B&&B.gain.setValueAtTime(1,C.currentTime)):Q===V?(ce(),G.gain.setValueAtTime(1,C.currentTime),L.gain.setValueAtTime(0,C.currentTime),B&&B.gain.setValueAtTime(0,C.currentTime)):Q===x&&(G.gain.setValueAtTime(0,C.currentTime),L.gain.setValueAtTime(1,C.currentTime),B&&B.gain.setValueAtTime(0,C.currentTime))}),[Q]),Object(n.useEffect)((function(){Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.audioWorklet.addModule("pulse-oscillator.js");case 3:W=new AudioWorkletNode(C,"pulse-oscillator"),P=new AnalyserNode(C,{smoothingTimeConstant:0}),B=new GainNode(C,{gain:0}),W.connect(P),W.connect(B),B.connect(_),ee(!0),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0),re(e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))()}),[]),ne?r.a.createElement("div",{className:O.Loading},"an error occured while loading the worklet: ",ne):$?r.a.createElement("div",{className:O.App},r.a.createElement(A,null,r.a.createElement(v,null,r.a.createElement("h2",null,"App Settings"),r.a.createElement(w,{name:"gain",value:I,min:0,max:1,step:.001,setter:Y,presets:[0,.3,.5,.8,1]}),r.a.createElement(d,{playType:Q,choices:[N,S,V,x],setPlayType:U}),r.a.createElement("h2",null,"Pulse Oscillator Settings"),r.a.createElement(w,{name:"frequency",value:a,min:-2e3,max:2e3,step:1,setter:c,presets:[-2e3,-880,-440,-220,-110,-55,0,55,110,220,440,880,2e3]}),r.a.createElement(w,{name:"detune",value:f,min:-2400,max:2400,step:1,setter:E,presets:[-2400,-1200,-600,0,600,1200,2400]}),r.a.createElement(w,{name:"pulseWidth",value:h,min:0,max:1,step:.001,setter:M,presets:[0,.01,.25,.5,.75,.99,1]}),r.a.createElement("br",null),r.a.createElement(b,{pulseWidth:h,numCycles:5})),r.a.createElement(v,{className:O.Col},r.a.createElement("h2",null,"Visualizations"),r.a.createElement("h3",null,"worker"),r.a.createElement(A,null,r.a.createElement(v,null,r.a.createElement(p,{analyser:P,chartType:"waveform"})),r.a.createElement(v,null,r.a.createElement(p,{analyser:P,chartType:"fft"}))),r.a.createElement("h3",null,"custom"),r.a.createElement(A,null,r.a.createElement(v,null,r.a.createElement(p,{analyser:z,chartType:"waveform"})),r.a.createElement(v,null,r.a.createElement(p,{analyser:z,chartType:"fft"}))),r.a.createElement("h3",null,"square"),r.a.createElement(A,null,r.a.createElement(v,null,r.a.createElement(p,{analyser:F,chartType:"waveform"})),r.a.createElement(v,null,r.a.createElement(p,{analyser:F,chartType:"fft"}))))),r.a.createElement(T.a,{href:"https://github.com/skratchdot/".concat(j.a)})):r.a.createElement("div",{className:O.Loading},"loading worklet...")};a(22);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(M,null)),document.getElementById("root"))}],[[14,1,2]]]);
//# sourceMappingURL=main.ee718a65.chunk.js.map