(this["webpackJsonpweb-audio-api-v2-issue-7"]=this["webpackJsonpweb-audio-api-v2-issue-7"]||[]).push([[0],[,,function(e,t,a){e.exports={App:"app_App__3ALCk",Loading:"app_Loading__ylwSY"}},function(e,t,a){e.exports={svg:"analyser-chart_svg__2S828"}},,,,function(e,t,a){e.exports={Col:"col_Col__1zaJG"}},,function(e,t,a){e.exports={Row:"row_Row__2P6i2"}},function(e){e.exports=JSON.parse('{"a":"web-audio-api-v2-issue-7"}')},,function(e,t,a){e.exports=a(20)},,,,,,,function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(5),l=a.n(c),u=a(1),o=a(6),i=a(3),s=function(e){var t=e.analyser,a=e.chartType,c=Object(n.useState)(),l=Object(u.a)(c,2),o=l[0],s=l[1],m=Object(n.useState)(""),f=Object(u.a)(m,2),p=f[0],d=f[1],E=r.a.useRef(),v=function e(){var n;if(t&&("waveform"===a?(n=new Float32Array(t.fftSize),t.getFloatTimeDomainData(n)):"fft"===a&&(n=new Float32Array(t.frequencyBinCount),t.getFloatFrequencyData(n)),n)){var r=n.reduce((function(e,t,a){return"".concat(e," M").concat(a,",0 L").concat(a,",").concat(t)}),"");d(r)}E.current=requestAnimationFrame(e)};return Object(n.useLayoutEffect)((function(){return E.current=requestAnimationFrame(v),function(){return cancelAnimationFrame(E.current)}}),[]),Object(n.useEffect)((function(){t&&("waveform"===a?s("0 -1 ".concat(t.fftSize," 2")):"fft"===a&&s("0 -120 ".concat(t.frequencyBinCount," 120")))}),[t,a]),r.a.createElement("svg",{preserveAspectRatio:"none",className:i.svg,viewBox:o},r.a.createElement("path",{stroke:"black",d:p}))},m=function(e){var t=e.playType,a=e.choices,n=e.setPlayType;return r.a.createElement("div",null,"audio output:",r.a.createElement("br",null),a.map((function(e){return r.a.createElement("button",{key:e,disabled:e===t,onClick:function(){return n(e)}},e)})))},f=a(7),p=function(e){var t=e.children;return r.a.createElement("div",{className:f.Col},t)},d=a(8),E=a.n(d),v=function(e){for(var t=e.numCycles,a=e.pulseWidth,n="",c=100*t,l=0;l<t;l++)for(var u=0;u<100;u++){var o=u/100<a?-1:1,s=100*l+u;n+="M".concat(s,",0 L").concat(s,",").concat(o)}return r.a.createElement("svg",{className:i.svg,preserveAspectRatio:"none",viewBox:"0 -1 ".concat(c," 2")},r.a.createElement("path",{stroke:"black",d:n}))},y=a(11),T=function(e){var t=e.presets,a=e.setter,n=Object(y.a)(e,["presets","setter"]);return r.a.createElement("div",null,n.name,":\xa0",r.a.createElement("small",null,n.value),r.a.createElement("br",null),r.a.createElement("input",Object.assign({},n,{type:"range",onChange:function(e){return a(parseFloat(e.target.value))}})),r.a.createElement("br",null),(t||[]).map((function(e){return r.a.createElement("button",{key:e,disabled:n.value===e,onClick:function(){return a(e)},style:{marginBottom:10}},e)})))},g=a(9),b=function(e){var t=e.children;return r.a.createElement("div",{className:g.Row},t)},h=a(2),w=a(10),A=Math.pow(2,12),O="stopped",j="worklet",N="custom",k="square",S=new AudioContext,V=new GainNode(S,{gain:0});V.connect(S.destination);var C=new OscillatorNode(S,{detune:0,frequency:440,type:"square"}),_=new AnalyserNode(S,{smoothingTimeConstant:0}),q=new GainNode(S,{gain:0});C.connect(q),q.connect(V),C.connect(_),C.start();var x,F,L,W=new OscillatorNode(S,{detune:0,frequency:440}),B=new AnalyserNode(S,{smoothingTimeConstant:0}),P=new GainNode(S,{gain:0});W.connect(P),P.connect(V),W.connect(B),W.start();var R=function(){var e=Object(n.useState)(440),t=Object(u.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(0),i=Object(u.a)(l,2),f=i[0],d=i[1],y=Object(n.useState)(.5),g=Object(u.a)(y,2),R=g[0],z=g[1],G=Object(n.useState)(0),M=Object(u.a)(G,2),J=M[0],D=M[1],I=Object(n.useState)(O),Y=Object(u.a)(I,2),H=Y[0],K=Y[1],Q=Object(n.useState)(!1),U=Object(u.a)(Q,2),X=U[0],Z=U[1],$=Object(n.useState)(),ee=Object(u.a)($,2),te=ee[0],ae=ee[1],ne=function(){for(var e=A*R,t=[],a=0;a<A;a++)t[a]=a<e?-1:1;var n=new o.FFT(t.length);n.forward(t);var r=S.createPeriodicWave(new Float32Array(n.real),new Float32Array(n.imag),{disableNormalization:!1});W.setPeriodicWave(r)};return Object(n.useEffect)((function(){W.frequency.setValueAtTime(a,S.currentTime),C.frequency.setValueAtTime(a,S.currentTime),x&&x.parameters.get("frequency").setValueAtTime(a,S.currentTime)}),[a]),Object(n.useEffect)((function(){W.detune.setValueAtTime(f,S.currentTime),C.detune.setValueAtTime(f,S.currentTime),x&&x.parameters.get("detune").setValueAtTime(f,S.currentTime)}),[f]),Object(n.useEffect)((function(){ne(),x&&x.parameters.get("pulseWidth").setValueAtTime(R,S.currentTime)}),[R]),Object(n.useEffect)((function(){V.gain.value=J}),[J]),Object(n.useEffect)((function(){H!==O&&"suspended"===S.state&&S.resume(),H===O?S.suspend():H===j?(P.gain.setValueAtTime(0,S.currentTime),q.gain.setValueAtTime(0,S.currentTime),F&&F.gain.setValueAtTime(1,S.currentTime)):H===N?(ne(),P.gain.setValueAtTime(1,S.currentTime),q.gain.setValueAtTime(0,S.currentTime),F&&F.gain.setValueAtTime(0,S.currentTime)):H===k&&(P.gain.setValueAtTime(0,S.currentTime),q.gain.setValueAtTime(1,S.currentTime),F&&F.gain.setValueAtTime(0,S.currentTime))}),[H]),Object(n.useEffect)((function(){S.audioWorklet.addModule("pulse-oscillator.js").then((function(){x=new AudioWorkletNode(S,"pulse-oscillator"),L=new AnalyserNode(S,{smoothingTimeConstant:0}),F=new GainNode(S,{gain:0}),x.connect(L),x.connect(F),F.connect(V),Z(!0)})).catch((function(e){console.error(e),ae(e.message)}))}),[]),te?r.a.createElement("div",{className:h.Loading},"an error occured while loading the worklet: ",te):X?r.a.createElement("div",{className:h.App},r.a.createElement(b,null,r.a.createElement(p,null,r.a.createElement("h2",null,"App Settings"),r.a.createElement(T,{name:"gain",value:J,min:0,max:1,step:.001,setter:D,presets:[0,.3,.5,.8,1]}),r.a.createElement(m,{playType:H,choices:[O,j,N,k],setPlayType:K}),r.a.createElement("h2",null,"Pulse Oscillator Settings"),r.a.createElement(T,{name:"frequency",value:a,min:-2e3,max:2e3,step:1,setter:c,presets:[-2e3,-880,-440,-220,-110,-55,0,55,110,220,440,880,2e3]}),r.a.createElement(T,{name:"detune",value:f,min:-2400,max:2400,step:1,setter:d,presets:[-2400,-1200,-600,0,600,1200,2400]}),r.a.createElement(T,{name:"pulseWidth",value:R,min:0,max:1,step:.001,setter:z,presets:[0,.01,.25,.5,.75,.99,1]}),r.a.createElement("br",null),r.a.createElement(v,{pulseWidth:R,numCycles:5})),r.a.createElement(p,{className:h.Col},r.a.createElement("h2",null,"Visualizations"),r.a.createElement("h3",null,"worker"),r.a.createElement(b,null,r.a.createElement(p,null,r.a.createElement(s,{analyser:L,chartType:"waveform"})),r.a.createElement(p,null,r.a.createElement(s,{analyser:L,chartType:"fft"}))),r.a.createElement("h3",null,"custom"),r.a.createElement(b,null,r.a.createElement(p,null,r.a.createElement(s,{analyser:B,chartType:"waveform"})),r.a.createElement(p,null,r.a.createElement(s,{analyser:B,chartType:"fft"}))),r.a.createElement("h3",null,"square"),r.a.createElement(b,null,r.a.createElement(p,null,r.a.createElement(s,{analyser:_,chartType:"waveform"})),r.a.createElement(p,null,r.a.createElement(s,{analyser:_,chartType:"fft"}))))),r.a.createElement(E.a,{href:"https://github.com/skratchdot/".concat(w.a)})):r.a.createElement("div",{className:h.Loading},"loading worklet...")};a(19);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(R,null)),document.getElementById("root"))}],[[12,1,2]]]);
//# sourceMappingURL=main.9981ef9b.chunk.js.map