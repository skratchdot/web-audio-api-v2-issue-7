(this["webpackJsonpweb-audio-api-v2-issue-7"]=this["webpackJsonpweb-audio-api-v2-issue-7"]||[]).push([[0],[,,function(e,t,a){e.exports={svg:"analyser-chart_svg__2S828",path:"analyser-chart_path__34OOx"}},function(e,t,a){e.exports={App:"app_App__3ALCk",Loading:"app_Loading__ylwSY"}},,,,,,function(e,t,a){e.exports={Col:"col_Col__1zaJG"}},,function(e,t,a){e.exports={Row:"row_Row__2P6i2"}},function(e){e.exports=JSON.parse('{"a":"web-audio-api-v2-issue-7"}')},,function(e,t,a){e.exports=a(23)},,,,,,,,function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(6),l=a.n(c),u=a(4),s=a.n(u),o=a(7),i=a(1),m=a(8),p=a(2),f=function(e){var t=e.analyser,a=e.chartType,c=Object(n.useState)(),l=Object(i.a)(c,2),u=l[0],s=l[1],o=Object(n.useState)(""),m=Object(i.a)(o,2),f=m[0],d=m[1],E=r.a.useRef(),v=function e(){var n,r,c;if(t&&("waveform"===a?(n=new Float32Array(t.fftSize),t.getFloatTimeDomainData(n),r=-1,c=1):"fft"===a&&(n=new Float32Array(t.frequencyBinCount),t.getFloatFrequencyData(n),r=-120,c=0),n)){var l=n.reduce((function(e,t,a){var n=t;return n<r?n=r:n>c?n=c:Number.isFinite(n)||(n=0),"".concat(e," M").concat(a,",0 L").concat(a,",").concat(n)}),"");d(l)}E.current=requestAnimationFrame(e)};return Object(n.useLayoutEffect)((function(){return E.current=requestAnimationFrame(v),function(){return cancelAnimationFrame(E.current)}}),[]),Object(n.useEffect)((function(){t&&("waveform"===a?s("0 ".concat(-1," ").concat(t.fftSize," ").concat(2)):"fft"===a&&s("0 ".concat(-120," ").concat(t.frequencyBinCount," ").concat(120)))}),[t,a]),r.a.createElement("svg",{preserveAspectRatio:"none",className:p.svg,viewBox:u},r.a.createElement("path",{d:f,className:p.path}))},d=function(e){var t=e.playType,a=e.choices,n=e.setPlayType;return r.a.createElement("div",null,"audio output:",r.a.createElement("br",null),a.map((function(e){return r.a.createElement("button",{key:e,disabled:e===t,onClick:function(){return n(e)}},e)})))},E=a(9),v=function(e){var t=e.children;return r.a.createElement("div",{className:E.Col},t)},y=a(10),T=a.n(y),b=function(e){for(var t=e.numCycles,a=e.pulseWidth,n="",c=100*t,l=0;l<t;l++)for(var u=0;u<100;u++){var s=u/100<a?-1:1,o=100*l+u;n+="M".concat(o,",0 L").concat(o,",").concat(s)}return r.a.createElement("svg",{className:p.svg,preserveAspectRatio:"none",viewBox:"0 -1 ".concat(c," 2")},r.a.createElement("path",{stroke:"black",d:n}))},g=a(13),h=function(e){var t=e.presets,a=e.setter,n=Object(g.a)(e,["presets","setter"]);return r.a.createElement("div",null,n.name,":\xa0",r.a.createElement("small",null,n.value),r.a.createElement("br",null),r.a.createElement("input",Object.assign({},n,{type:"range",onChange:function(e){return a(parseFloat(e.target.value))}})),r.a.createElement("br",null),(t||[]).map((function(e){return r.a.createElement("button",{key:e,disabled:n.value===e,onClick:function(){return a(e)},style:{marginBottom:10}},e)})))},w=a(11),A=function(e){var t=e.children;return r.a.createElement("div",{className:w.Row},t)},O=a(3),j=a(12),N=Math.pow(2,12),k="stopped",_="worklet",x="custom",S="square",V=new AudioContext,C=new GainNode(V,{gain:0});C.connect(V.destination);var q=new OscillatorNode(V,{detune:0,frequency:440,type:"square"}),F=new AnalyserNode(V,{smoothingTimeConstant:0}),L=new GainNode(V,{gain:0});q.connect(L),L.connect(C),q.connect(F),q.start();var W,B,P,R=new OscillatorNode(V,{detune:0,frequency:440}),z=new AnalyserNode(V,{smoothingTimeConstant:0}),G=new GainNode(V,{gain:0});R.connect(G),G.connect(C),R.connect(z),R.start();var M=function(){var e=Object(n.useState)(440),t=Object(i.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(0),u=Object(i.a)(l,2),p=u[0],E=u[1],y=Object(n.useState)(.5),g=Object(i.a)(y,2),w=g[0],M=g[1],J=Object(n.useState)(0),D=Object(i.a)(J,2),I=D[0],Y=D[1],H=Object(n.useState)(k),K=Object(i.a)(H,2),Q=K[0],U=K[1],X=Object(n.useState)(!1),Z=Object(i.a)(X,2),$=Z[0],ee=Z[1],te=Object(n.useState)(),ae=Object(i.a)(te,2),ne=ae[0],re=ae[1],ce=function(){for(var e=N*w,t=[],a=0;a<N;a++)t[a]=a<e?-1:1;var n=new m.FFT(t.length);n.forward(t);var r=V.createPeriodicWave(new Float32Array(n.real),new Float32Array(n.imag),{disableNormalization:!1});R.setPeriodicWave(r)};return Object(n.useEffect)((function(){R.frequency.setValueAtTime(a,V.currentTime),q.frequency.setValueAtTime(a,V.currentTime),W&&W.parameters.get("frequency").setValueAtTime(a,V.currentTime)}),[a]),Object(n.useEffect)((function(){R.detune.setValueAtTime(p,V.currentTime),q.detune.setValueAtTime(p,V.currentTime),W&&W.parameters.get("detune").setValueAtTime(p,V.currentTime)}),[p]),Object(n.useEffect)((function(){ce(),W&&W.parameters.get("pulseWidth").setValueAtTime(w,V.currentTime)}),[w]),Object(n.useEffect)((function(){C.gain.value=I}),[I]),Object(n.useEffect)((function(){Q!==k&&"suspended"===V.state&&V.resume(),Q===k?V.suspend():Q===_?(G.gain.setValueAtTime(0,V.currentTime),L.gain.setValueAtTime(0,V.currentTime),B&&B.gain.setValueAtTime(1,V.currentTime)):Q===x?(ce(),G.gain.setValueAtTime(1,V.currentTime),L.gain.setValueAtTime(0,V.currentTime),B&&B.gain.setValueAtTime(0,V.currentTime)):Q===S&&(G.gain.setValueAtTime(0,V.currentTime),L.gain.setValueAtTime(1,V.currentTime),B&&B.gain.setValueAtTime(0,V.currentTime))}),[Q]),Object(n.useEffect)((function(){Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,V.audioWorklet.addModule("pulse-oscillator.js");case 3:W=new AudioWorkletNode(V,"pulse-oscillator"),P=new AnalyserNode(V,{smoothingTimeConstant:0}),B=new GainNode(V,{gain:0}),W.connect(P),W.connect(B),B.connect(C),ee(!0),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0),re(e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))()}),[]),ne?r.a.createElement("div",{className:O.Loading},"an error occured while loading the worklet: ",ne):$?r.a.createElement("div",{className:O.App},r.a.createElement(A,null,r.a.createElement(v,null,r.a.createElement("h2",null,"App Settings"),r.a.createElement(h,{name:"gain",value:I,min:0,max:1,step:.001,setter:Y,presets:[0,.3,.5,.8,1]}),r.a.createElement(d,{playType:Q,choices:[k,_,x,S],setPlayType:U}),r.a.createElement("h2",null,"Pulse Oscillator Settings"),r.a.createElement(h,{name:"frequency",value:a,min:-2e3,max:2e3,step:1,setter:c,presets:[-2e3,-880,-440,-220,-110,-55,0,55,110,220,440,880,2e3]}),r.a.createElement(h,{name:"detune",value:p,min:-2400,max:2400,step:1,setter:E,presets:[-2400,-1200,-600,0,600,1200,2400]}),r.a.createElement(h,{name:"pulseWidth",value:w,min:0,max:1,step:.001,setter:M,presets:[0,.01,.25,.5,.75,.99,1]}),r.a.createElement("br",null),r.a.createElement(b,{pulseWidth:w,numCycles:5})),r.a.createElement(v,{className:O.Col},r.a.createElement("h2",null,"Visualizations"),r.a.createElement("h3",null,"worker"),r.a.createElement(A,null,r.a.createElement(v,null,r.a.createElement(f,{analyser:P,chartType:"waveform"})),r.a.createElement(v,null,r.a.createElement(f,{analyser:P,chartType:"fft"}))),r.a.createElement("h3",null,"custom"),r.a.createElement(A,null,r.a.createElement(v,null,r.a.createElement(f,{analyser:z,chartType:"waveform"})),r.a.createElement(v,null,r.a.createElement(f,{analyser:z,chartType:"fft"}))),r.a.createElement("h3",null,"square"),r.a.createElement(A,null,r.a.createElement(v,null,r.a.createElement(f,{analyser:F,chartType:"waveform"})),r.a.createElement(v,null,r.a.createElement(f,{analyser:F,chartType:"fft"}))))),r.a.createElement(T.a,{href:"https://github.com/skratchdot/".concat(j.a)})):r.a.createElement("div",{className:O.Loading},"loading worklet...")};a(22);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(M,null)),document.getElementById("root"))}],[[14,1,2]]]);
//# sourceMappingURL=main.d80b33c3.chunk.js.map