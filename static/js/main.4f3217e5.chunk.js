(this["webpackJsonpweb-audio-api-v2-issue-7"]=this["webpackJsonpweb-audio-api-v2-issue-7"]||[]).push([[0],[,,,,function(e,t,a){e.exports={svg:"analyser-chart_svg__2S828",path:"analyser-chart_path__34OOx"}},function(e,t,a){e.exports={pre:"demo-2_pre__2_gw9",code:"demo-2_code__3ESEA"}},,function(e,t,a){e.exports={Loading:"demo-1_Loading__JbyOo"}},,function(e){e.exports=JSON.parse('{"a":"web-audio-api-v2-issue-7"}')},,,,function(e,t,a){e.exports={Col:"col_Col__1zaJG"}},,function(e,t,a){e.exports={Row:"row_Row__2P6i2"}},function(e,t,a){e.exports={App:"app_App__3ALCk"}},function(e,t,a){e.exports=a(26)},,,,,,,,function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(12),l=a.n(c),o=a(1),u=a(2),s=a(13),i=function(e){var t=e.children,a=Object(u.a)(e,["children"]);return r.a.createElement("div",Object.assign({},a,{className:s.Col}),t)},m=a(14),d=a.n(m),f=a(15),p=function(e){var t=e.children,a=Object(u.a)(e,["children"]);return r.a.createElement("div",Object.assign({},a,{className:f.Row}),t)},E=a(16),g=a(9),b=a(3),v=a.n(b),y=a(10),h=a(6),O=a(8),w=a(4),T=function(e){var t=e.analyser,a=e.chartType,c=Object(n.useState)(),l=Object(o.a)(c,2),u=l[0],s=l[1],i=Object(n.useState)(""),m=Object(o.a)(i,2),d=m[0],f=m[1],p=r.a.useRef(),E=function e(){var n,r,c;if(t&&("waveform"===a?(n=new Float32Array(t.fftSize),t.getFloatTimeDomainData(n),r=-1,c=1):"fft"===a&&(n=new Float32Array(t.frequencyBinCount),t.getFloatFrequencyData(n),r=-120,c=0),n)){var l=n.reduce((function(e,t,a){var n=t;return n<r?n=r:n>c?n=c:Number.isFinite(n)||(n=0),"".concat(e," M").concat(a,",0 L").concat(a,",").concat(n)}),"");f(l)}p.current=requestAnimationFrame(e)};return Object(n.useLayoutEffect)((function(){return p.current=requestAnimationFrame(E),function(){return cancelAnimationFrame(p.current)}}),[]),Object(n.useEffect)((function(){t&&("waveform"===a?s("0 ".concat(-1," ").concat(t.fftSize," ").concat(2)):"fft"===a&&s("0 ".concat(-120," ").concat(t.frequencyBinCount," ").concat(120)))}),[t,a]),r.a.createElement("svg",{preserveAspectRatio:"none",className:w.svg,viewBox:u},r.a.createElement("path",{d:d,className:w.path}))},j=function(e){var t=e.playType,a=e.choices,n=e.setPlayType;return r.a.createElement("div",null,"audio output:",r.a.createElement("br",null),a.map((function(e){return r.a.createElement("button",{key:e,disabled:e===t,onClick:function(){return n(e)}},e)})))},A=function(e){for(var t=e.numCycles,a=e.pulseWidth,n="",c=100*t,l=0;l<t;l++)for(var o=0;o<100;o++){var u=o/100<a?-1:1,s=100*l+o;n+="M".concat(s,",0 L").concat(s,",").concat(u)}return r.a.createElement("svg",{className:w.svg,preserveAspectRatio:"none",viewBox:"0 -1 ".concat(c," 2")},r.a.createElement("path",{stroke:"black",d:n}))},k=function(e){var t=e.presets,a=e.setter,n=Object(u.a)(e,["presets","setter"]);return r.a.createElement("div",null,n.name,":\xa0",r.a.createElement("small",null,n.value),r.a.createElement("br",null),r.a.createElement("input",Object.assign({},n,{type:"range",onChange:function(e){return a(parseFloat(e.target.value))}})),r.a.createElement("br",null),(t||[]).map((function(e){return r.a.createElement("button",{key:e,disabled:n.value===e,onClick:function(){return a(e)},style:{marginBottom:10}},e)})))},S=a(7),N=Math.pow(2,12),C="stopped",_="worklet",x="custom",q="square",W=function(){var e=Object(n.useState)(440),t=Object(o.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(0),u=Object(o.a)(l,2),s=u[0],m=u[1],d=Object(n.useState)(.5),f=Object(o.a)(d,2),E=f[0],g=f[1],b=Object(n.useState)(0),w=Object(o.a)(b,2),W=w[0],V=w[1],F=Object(n.useState)(C),L=Object(o.a)(F,2),M=L[0],R=L[1],P=Object(n.useState)(!1),B=Object(o.a)(P,2),G=B[0],z=B[1],J=Object(n.useState)(),D=Object(o.a)(J,2),I=D[0],H=D[1],K=Object(n.useState)((function(){var e=new AudioContext,t=new GainNode(e,{gain:0}),a=new GainNode(e,{gain:0}),n=new GainNode(e,{gain:0}),r=new OscillatorNode(e,{detune:0,frequency:440,type:"square"}),c=new OscillatorNode(e,{detune:0,frequency:440}),l=new AnalyserNode(e,{smoothingTimeConstant:0}),o=new AnalyserNode(e,{smoothingTimeConstant:0});return t.connect(e.destination),r.connect(a),a.connect(t),r.connect(l),r.start(),c.connect(n),n.connect(t),c.connect(o),c.start(),{ac:e,gainMain:t,gainSquare:a,gainCustom:n,gainWorklet:void 0,oscSquare:r,oscCustom:c,oscWorklet:void 0,analyserSquare:l,analyserCustom:o,analyserWorklet:void 0}})),Q=Object(o.a)(K,2),U=Q[0],X=U.ac,Y=U.gainMain,Z=U.gainSquare,$=U.gainCustom,ee=U.gainWorklet,te=U.oscSquare,ae=U.oscCustom,ne=U.oscWorklet,re=U.analyserSquare,ce=U.analyserCustom,le=U.analyserWorklet,oe=Q[1],ue=function(){for(var e=N*E,t=[],a=0;a<N;a++)t[a]=a<e?-1:1;var n=new O.FFT(t.length);n.forward(t);var r=X.createPeriodicWave(new Float32Array(n.real),new Float32Array(n.imag),{disableNormalization:!1});ae.setPeriodicWave(r)};return Object(n.useEffect)((function(){ae.frequency.setValueAtTime(a,X.currentTime),te.frequency.setValueAtTime(a,X.currentTime),ne&&ne.parameters.get("frequency").setValueAtTime(a,X.currentTime)}),[a]),Object(n.useEffect)((function(){ae.detune.setValueAtTime(s,X.currentTime),te.detune.setValueAtTime(s,X.currentTime),ne&&ne.parameters.get("detune").setValueAtTime(s,X.currentTime)}),[s]),Object(n.useEffect)((function(){ue(),ne&&ne.parameters.get("pulseWidth").setValueAtTime(E,X.currentTime)}),[E]),Object(n.useEffect)((function(){Y.gain.value=W}),[W]),Object(n.useEffect)((function(){M!==C&&"suspended"===X.state&&X.resume(),M===C?X.suspend():M===_?($.gain.setValueAtTime(0,X.currentTime),Z.gain.setValueAtTime(0,X.currentTime),ee&&ee.gain.setValueAtTime(1,X.currentTime)):M===x?(ue(),$.gain.setValueAtTime(1,X.currentTime),Z.gain.setValueAtTime(0,X.currentTime),ee&&ee.gain.setValueAtTime(0,X.currentTime)):M===q&&($.gain.setValueAtTime(0,X.currentTime),Z.gain.setValueAtTime(1,X.currentTime),ee&&ee.gain.setValueAtTime(0,X.currentTime))}),[M]),Object(n.useEffect)((function(){return Object(h.a)(v.a.mark((function e(){var t,a,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X.audioWorklet.addModule("pulse-oscillator.js");case 3:t=new AudioWorkletNode(X,"pulse-oscillator"),a=new AnalyserNode(X,{smoothingTimeConstant:0}),n=new GainNode(X,{gain:0}),t.connect(a),t.connect(n),n.connect(Y),oe((function(e){return Object(y.a)(Object(y.a)({},e),{},{oscWorklet:t,analyserWorklet:a,gainWorklet:n})})),z(!0),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0),H(e.t0.message);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})))(),function(){X.close()}}),[]),I?r.a.createElement("div",{className:S.Loading},"an error occured while loading the worklet: ",I):G?r.a.createElement(p,null,r.a.createElement(i,null,r.a.createElement("h2",null,"App Settings"),r.a.createElement(k,{name:"gain",value:W,min:0,max:1,step:.001,setter:V,presets:[0,.3,.5,.8,1]}),r.a.createElement(j,{playType:M,choices:[C,_,x,q],setPlayType:R}),r.a.createElement("h2",null,"Pulse Oscillator Settings"),r.a.createElement(k,{name:"frequency",value:a,min:-2e3,max:2e3,step:1,setter:c,presets:[-2e3,-880,-440,-220,-110,-55,0,55,110,220,440,880,2e3]}),r.a.createElement(k,{name:"detune",value:s,min:-2400,max:2400,step:1,setter:m,presets:[-2400,-1200,-600,0,600,1200,2400]}),r.a.createElement(k,{name:"pulseWidth",value:E,min:0,max:1,step:.001,setter:g,presets:[0,.01,.25,.5,.75,.99,1]}),r.a.createElement("br",null),r.a.createElement(A,{pulseWidth:E,numCycles:5})),r.a.createElement(i,{className:S.Col},r.a.createElement("h2",null,"Visualizations"),r.a.createElement("h3",null,"worklet"),r.a.createElement(p,null,r.a.createElement(i,null,r.a.createElement(T,{analyser:le,chartType:"waveform"})),r.a.createElement(i,null,r.a.createElement(T,{analyser:le,chartType:"fft"}))),r.a.createElement("h3",null,"custom"),r.a.createElement(p,null,r.a.createElement(i,null,r.a.createElement(T,{analyser:ce,chartType:"waveform"})),r.a.createElement(i,null,r.a.createElement(T,{analyser:ce,chartType:"fft"}))),r.a.createElement("h3",null,"square"),r.a.createElement(p,null,r.a.createElement(i,null,r.a.createElement(T,{analyser:re,chartType:"waveform"})),r.a.createElement(i,null,r.a.createElement(T,{analyser:re,chartType:"fft"}))))):r.a.createElement("div",{className:S.Loading},"loading worklet...")},V=a(5),F=function(){var e=Object(n.useRef)(),t=Object(n.useRef)(),a=Object(n.useState)(!1),c=Object(o.a)(a,2),l=c[0],u=c[1],s=Object(n.useState)(),m=Object(o.a)(s,2),d=m[0],f=m[1];return Object(n.useEffect)((function(){var a=new AudioContext;return Object(h.a)(v.a.mark((function e(){var n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.audioWorklet.addModule("pulse-oscillator.js");case 3:(n=new AudioWorkletNode(a,"pulse-oscillator")).parameters.get("frequency").setValueAtTime(200,a.currentTime),r=new GainNode(a,{gain:.2}),n.connect(r),t.current=new AnalyserNode(a,{smoothingTimeConstant:0}),n.connect(t.current),u(!0),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0),f(e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))(),e.current=a,function(){e.current.close()}}),[]),d?r.a.createElement("div",{className:V.Loading},"an error occured while loading the worklet: ",d):l?r.a.createElement(r.a.Fragment,null,r.a.createElement(p,null,r.a.createElement(i,null,"The goal if this demo is to emulate the following SuperCollider code using the webaudio api",r.a.createElement("pre",{className:V.pre},r.a.createElement("code",{className:V.code},"{ Pulse.ar(200, SinOsc.kr(0.2).range(0, 1), 0.2) }.play;")))),r.a.createElement(p,null,r.a.createElement(i,null,r.a.createElement("button",{disabled:!0},"stop"),r.a.createElement("button",{disabled:!0},"start"))),r.a.createElement(p,null,r.a.createElement(i,{style:{margin:20,padding:20}},"The demo is currently incomplete/unfinished"))):r.a.createElement("div",{className:V.Loading},"loading worklet...")},L=function(){var e,t=Object(n.useState)("demo1"),a=Object(o.a)(t,2),c=a[0],l=a[1];return"demo1"===c?e=r.a.createElement(W,null):"demo2"===c&&(e=r.a.createElement(F,null)),r.a.createElement("div",{className:E.App},r.a.createElement(p,null,r.a.createElement(i,null,r.a.createElement("h1",null,g.a)),r.a.createElement(i,{style:{alignSelf:"center"}},["demo1","demo2"].map((function(e){return r.a.createElement("button",{disabled:c===e,onClick:function(){return l(e)}},e)})))),r.a.createElement(p,null,r.a.createElement(i,null,e)),r.a.createElement(d.a,{href:"https://github.com/skratchdot/".concat(g.a)}))};a(25);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(L,null)),document.getElementById("root"))}],[[17,1,2]]]);
//# sourceMappingURL=main.4f3217e5.chunk.js.map